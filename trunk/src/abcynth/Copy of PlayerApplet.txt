package abc.player;

import java.awt.*;
import java.awt.event.*;
import javax.swing.event.*;
import javax.swing.*;
import javax.swing.table.*;
import java.awt.SystemColor;
import abc.notation.*;
import abc.parser.*;
import abc.midi.*;
import scanner.*;
import java.util.*;
import java.io.*;

/** A simple user interface to display abc files content and play
 * tunes. */
public class PlayerApplet extends JApplet
{
  private TuneBookEditorPanel m_tuneBookEditorPanel = null;
  private TunePlayer m_player = null;

  public PlayerApplet()
  {
    JFrame frame = new JFrame("test");
    frame.setVisible(true);
    m_player = new TunePlayer();
    m_player.start();
    PlayerUI pUI = new PlayerUI(m_player);
    pUI.getPlayButton().addActionListener(new ActionListener()
    {
      public void actionPerformed(ActionEvent e)
      {
        Tune tune2play = null;
        if (m_tuneBookEditorPanel.isEditingTune())
          tune2play = new TuneParser().parse(m_tuneBookEditorPanel.getCurrentTuneNotation());
        else
          tune2play = m_tuneBookEditorPanel.getSelectedTune();
        if (!m_player.isPlaying())
          m_player.play(tune2play);
        else m_player.stopPlaying();
      }
    });


//    JPanel globalPanel = new JPanel(new BorderLayout());
    m_tuneBookEditorPanel = new TuneBookEditorPanel();
    try
    {
      InputStream is = getClass().getResourceAsStream("/abc/parser/ceili.abc");
      InputStreamReader reader = new InputStreamReader(is);
      m_tuneBookEditorPanel.setTuneBook(new TuneBook(reader));
    }
    catch (Exception e)
    { e.printStackTrace(); }

    getContentPane().add(pUI, BorderLayout.NORTH);
    getContentPane().add(m_tuneBookEditorPanel, BorderLayout.CENTER);
  }

  public void init()
  {
    m_tuneBookEditorPanel.setDividerLocation(getHeight()/2);
  }

}
